---
layout: post
title:  "现代操作系统（01）"
categories:  读书笔记 引论
---

## 计算机组成
- 硬件
- 软件
    - 内核态：可以执行机器能够运行的任何指令，具有对所有硬件的完全访问权（操作系统）
    - 用户态：只能使用机器指令中的一个子集。特别是会影响机器的控制或可进行I/O操作的执行，在用户态的程序中是被禁止的。（用户程序）

## 操作系统定义
为应用程序提供一个资源集的清晰抽象，并管理这些硬件资源。

### 定义，实现及管理抽象
抽象是管理复杂性的一个关键。好的抽象可以把一个几乎不可能管理的任务划分为两个可管理的部分
- 有关抽象的的定义和实现
- 随时用这些抽象解决问题

操作系统将存储设备抽象为“文件” 

### 做为资源管理者
操作系统的任务是在相互竞争的程序之间有序地控制对处理器，存储器以及其他I/O接口设备的分配

## 计算机硬件
CPU，内存及I/O设备都由一条系统总线连接起来并通过总线和其他设备通信。

### 处理器（CPU）
在每CPU基本周期中，从内存中取出指令并执行。   
每种CPU都有特定的一套可执行指令集。      
所有CPU内都有一些用来保存关键变量和临时数据的寄存器。    
以及一些专用寄存器
- 程序计数器，保存将要取出的下一条指令的地址。
- 堆栈指针，指向内存中当前栈的顶端。
- 程序状态字，包含了条件码位，CPU优先级，模式及各种其他控制位。

### 存储器
分层结构，自顶向下，速度减少，容量增加，价格降低    
寄存器 -》高速缓存 -》主存 -》磁盘
在任何缓存系统中，都需要考虑以下问题：
- 何时把一个新的内容放入缓存
- 把新内容放在缓存的哪一行
- 在需要时，应该把哪个内容从缓存中移走
- 应该把新移走的内容放在某个较大存储器的何处

### I/O设备
I/O设备包括：
- 设备控制器。插在电路板上的一块芯片或一组芯片，这块电路板物理地控制设备。并为操作系统提供一个简单的接口。
- 设备本身。有一个简单的接口，并被标准化了。
设备驱动程序：专门与控制器对话，发出命令并接收响应的软件。
每个控制器厂家必须为所支持的操作系统提供相应的设备驱动程序。
I/O端口空间：所有设备寄存器的集合。
实现输入和输出的方式：
- 忙等待：用户程序发出一个系统调用，内核将其翻译为一个对应设备驱动程序的过程调用。设备驱动程序启动I/O并在一个连续不断的循环中检查该设备是否完成了工作。
- 中断：驱动设备启动设备并让该设备在操作完成时发出一个中断。
- 直接存储器访问：DMA芯片

### 总线
例如：高速缓存，内存，PCIe，PCI，USB，SATA，DMI。每条总线的传输速度和功能都不相同。
共享总线框架：多个设备使用一些相同的导线传输数据。
USB：是用来将所有慢速I/O设备（鼠标和键盘）与计算机相连。

### 启动计算机
每台计算机上有一块双亲板。
在双亲板上有一个基本输入输出系统（BIOS）
BIOS内有底层I/O软件。被存放在一块高速RAM中，是非易失性的。
BIOS首先检查所安装的RAM数量，键盘和其他基本设备是否已经安装并正常响应。
BIOS通过尝试存储在CMOS存储器中的设备清单决定启动设备g g h




## 操作系统概念
### 进程
进程本质上是正在执行的一个程序。
与每个进程相关
- 地址空间。在这个地址空间中，进程可以进行读写。该地址空间中存放有可执行程序，程序的数据以及程序的堆栈。
- 资源集。包括寄存器，打开文件的清单，突出的报警，有关进程清单等。
进程基本上是容纳运行一个程序所需要的所有信息的容器。
一个进程被挂起后，在该进程再次启动时的状态必须与先前暂停时完全相同。
进程表：与一个进程有关的所有信息，除了该进程自身地址空间的内容以外，均存放在操作系统的一张表中。
### 文件
隐藏磁盘和其他I/O设备的细节特性，提供一个良好，清晰的独立于设备的抽象文件模型。
目录：将文件分类成组。
管道：是一种虚文件，可连接两个进程
### 保护
UNIX通过对每个文件赋予一个9位的二进制保护代码。有3个3位字段，一个用于所有者，一个用于与所有者同组的其他成员，一个用于其他人。r位用于读访问，w位用于写访问，x位用于执行访问。
### 虚拟内存
通过在RAM和磁盘中反复移动信息块的方式，提供了运行比机器物理内存大的程序的能力。
