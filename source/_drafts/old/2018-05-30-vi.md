## 启动vi
使用vi编辑一个已有的文件：
```
vi [filename]
```
创建一个新文件：
```
vi [filename]
```
创建一个空文件，当保存数据时再指定文件命名
```
vi
```

## 退出

| 命令        | 效果                                     |
| ----------- | ---------------------------------------- |
| :q          | 退出                                     |
| :q!         | 不检查是否保存了数据，直接退出           |
| :x          | 保存并退出                               |
| `<Shift>`ZZ | 按下并保持<Shift>，按 z 两次，保存并退出 |

ps：
！具有强制意味，忽略检查和错误，强制执行。
如果修改了数据，并使用:q 命令退出，则会显示警告信息，并不会直接退出。

## 移动光标

当前行：光标所在的行

| 命令          | 效果                                       |
| ------------- | ------------------------------------------ |
| h             | 将光标向左移动一个位置                     |
| j             | 将光标向下移动一个位置                     |
| k             | 将光标向上移动一个位置                     |
| l             | 将光标向右移动一个位置                     |
| `<Left>`      | 将光标向左移动一个位置                     |
| `<Down>`      | 将光标向下移动一个位置                     |
| `<Up>`        | 将光标向上移动一个位置                     |
| `<Right>`     | 将光标向右移动一个位置                     |
| `<Backspace>` | 将光标向左移动一个位置                     |
| `<Space>`     | 将光标向右移动一个位置                     |
| -             | 将光标移动到上一行的开头                   |
| +             | 将光标移动到下一行的开头                   |
| `<Return>`    | 将光标移动到下一行的开头                   |
| 0             | 将光标移动到当前行的开头                   |
| $             | 将光标移动到当前行的末尾                   |
| ^             | 将光标移动到当前行的第一个非空白符的字符上 |
| w             | 将光标移动到下一个单词的词首               |
| e             | 将光标移动到下一个单词的词尾               |
| b             | 将光标移动到上一个单词的词首               |
| W             | 同 w，忽略标点符号                         |
| E             | 同 e，忽略标点符号                         |
| B             | 同 b，忽略标点符号                         |
| )             | 移动到下一个句子句首                       |
| (             | 移动到上一个句子句首                       |
| }             | 移动到下一个段落                           |
| {             | 移动到上一个段落                           |
| H             | 将光标移动到屏幕顶部                       |
| M             | 将光标移动到屏幕中间                       |
| L             | 将光标移动到屏幕最后一行                   |

ps：
句子：一个字符串，以句号，逗号，问号，或感叹号结尾，后面至少跟两个空格或一个新行字符。

段落：以一个空白行开头，并以一个空白行结束的一块文本区域。

## 在编辑缓冲区移动

| 命令 | 效果         |
| ---- | ------------ |
| ^F   | 向下移动一屏 |
| ^B   | 向上移动一屏 |
| ^D   | 向下移动半屏 |
| ^U   | 向上移动半屏 |

ps：
在对^D 和^U 前键入数字时，设置的是应该跳转的行数，并且会一直保持这个设定到改变数字。

## 跳转到前一位置

| 命令 | 效果                                                 |
| ---- | ---------------------------------------------------- |
| ``   | 回到前一位置                                         |
| m    | 后加一个字母，如 ma，即用这个字母标记该行            |
| \`   | 后跟指定行的标记名称，如`a，跳转到标记该行的准确位置 |
| '    | 后跟指定行的标记名称，如'a，跳转到标记行的行首       |

## 搜索

| 命令     | 效果                                                         |
| -------- | ------------------------------------------------------------ |
| /pattern | pattern 为希望搜索的模式，光标将跳转到接下来包含该模式的行上 |
| /        | 重复上一模式向前搜索                                         |
| ?pattern | pattern 为希望搜索的模式，光标将跳转到之前包含该模式的行上   |
| ?        | 重复上一模式向后搜索                                         |
| n        | 沿和之前相同的方向进行搜索                                   |
| N        | 沿和之前相反的方向进行搜索                                   |

ps：
搜索结果高亮显式

取消高亮：noh

## 使用行号

| 命令        | 效果                             |
| ----------- | -------------------------------- |
| :set number | 显示[行号]                       |
| ^G          | 显示文件名称，位置（行，百分比） |
| :[行号]     | 跳转到指定行                     |
| gg          | 跳转到第一行                     |

## 插入文本

| 命令 | 效果                                                        |
| ---- | ----------------------------------------------------------- |
| i    | 改变到输入模式：在当前光标位置前插入数据                    |
| a    | 改变到输入模式：在当前光标位置后插入数据                    |
| I    | 改变到输入模式：在当前行开头插入数据                        |
| A    | 改变到输入模式：在当前行末尾插入数据                        |
| o    | 改变到输入模式：在当前行下插入一行                          |
| O    | 改变到输入模式：在当前行行插入一行                          |
| ^V   | 控制字符 在输入模式下，插入控制字符（如^V^H  插入一个退格） |

## 修改文本

| 命令                 | 效果                                                                                               |
| -------------------- | -------------------------------------------------------------------------------------------------- |
| r                    | 后跟新字符，将当前字符更换为新字符                                                                 |
| R                    | 改变到 REPLACE 模式，随后键入的每个字符都将替换当前行上光标后（包括光标）的一个字符                |
| s                    | 改变到输入模式，多个字符替代一个字符                                                               |
| C                    | 替换从当前光标位置到这一行末尾的所有字符                                                           |
| S                    | 替换一整行                                                                                         |
| cc                   | 替换一整行                                                                                         |
| c                    | 后跟光标移动命令，替换从光标当前位置到移动命令所指定位置的所有字符。如 c5w，替换 5 个单词          |
| :s/pattern/replace   | 替换当前行上 pattern 的第一个匹配项为 replace，可在;和 s 中指定行号，以 , 分隔两个行号，可表示范围 |
| :s/pattern/replace/g | 替换当前行上所有的匹配项                                                                           |
| :s/pattern/replace/c | 替换前需确认                                                                                       |

ps：
.  代表当前行

$  代表编辑缓冲区的最后一行

%  代表编辑缓冲区所有的行

## 删除文本

| 命令      | 效果                                                         |
| --------- | ------------------------------------------------------------ |
| x         | 删除当前光标处的字符                                         |
| X         | 删除当前光标左边的字符                                       |
| D         | 删除从当前光标到本行末尾的字符                               |
| d         | 后跟光标移动命令，删除从当前光标到光标移动命令指定位置的字符 |
| dd        | 删除当前行，光标移动到下一行行首                             |
| :[行号 d] | 删除指行                                                     |

|:[行号 1],[行号 2]d | 删除[行号 1]，到[行号 2] 的行|
| ^W |输入模式下，删除光标之前的一个单词|
|^U| 输入模式下，删除光标之前的一行|
ps：
10dd，删除从当前行开始 10 行的文本

## 撤销或重复改变

| 命令   | 效果                                         |
| ------ | -------------------------------------------- |
| u      | 撤销上一命令对编辑缓冲区的修改               |
| U      | 恢复当前行                                   |
| .      | 重复上一命令对编辑缓冲区的修改               |
| p      | 复制上一次删除的内容，插入到光标之后         |
| P      | 复制上一次删除的内容，插入到光标之前         |
| 编号 p | 将编号缓冲区中相应编号的内容插入当前行的下面 |
| 编号 P | 将编号缓冲区中相应编号的内容插入当前行的上面 |

ps：
无名缓冲区：保存上一次删除保留的副本。

编号缓冲区：vi 将删除内容保存在编号缓冲区中，并从 1 ～ 9 编号。

组合命令：

xp  调换两个字符

deep  调换两个单词

ddp  调换两行

## 复制文本

| 命令                         | 效果                                                 |
| ---------------------------- | ---------------------------------------------------- |
| y                            | 后接光标移动命令，复制从当前光标到光标指定位置的字符 |
| yy 复制整行                  |
| Y                            | 复制整行                                             |
| :[行号 1]co[行号 2]          | 复制[行号 1] 的行到[行号 2] 的行下面                 |
| :[行号 1],[行号 2]co[行号 3] | 复制[行号 1] 到[行号 2] 之间的行到行号的行 3 下面    |

ps：
复制的文本保存在无名缓冲区中。可以使用 p 取出。

10yy，复制从当前行开始 10 行的内容。

## 移动文本

| 命令                        | 效果                                                |
| --------------------------- | --------------------------------------------------- |
| :[行号 1]m[行号 2]          | 移动[行号 1] 的行到[行号 2] 的行下面                |
| :[行号 1],[行号 2]m[行号 3] | 移动[行号 1] 到[行号 2] 之间的行到[行号 3] 的行下面 |

## 改变字母大小写

| 命令 | 效果                     |
| ---- | ------------------------ |
| ~    | 改变光标所在字符的大小写 |

ps：
若光标所在字符是非字母，光标像前移动一个位置，不进行改变。

10~  改变从光标所在字符开始 10 个字符的大小写。

## 连接行

| 命令 | 效果                           |
| ---- | ------------------------------ |
| J    | 把当前行和下一行合并成一个长行 |

ps：
当 vi 在连接行时，会在合适的位置自动地插入空格，即，在句子末尾插入两个空格。

3J  连接当前行开始 3 行为一个长行。

## 输入 shell 命令

| 命令   | 效果                                               |
| ------ | -------------------------------------------------- | --- |
| :!命令 | 将命令发送给 shell 执行，当命令结束后，控制返回 vi |
| ;!!    | 重复执行最近一条 shell 命令                        |     |
| :sh    | 暂停 vi，并启动一个新的默认 shell 副本             |

## 插入文件数据

| 命令          | 效果                         |
| ------------- | ---------------------------- |
| :[行号]r 文件 | 将文件内容插入到行号的行下面 |

## 插入 shell 命令输出

| 命令            | 效果                           |
| --------------- | ------------------------------ |
| :[行号]r ！命令 | 将命令的输出插入到行号的行下面 |

ps：
行号未指定，则为当前行

## 将数据写入文件

| 命令     | 效果                    |
| -------- | ----------------------- |
| :w       | 将数据写入原始文件      |
| ;w       | 文件 将数据写入新文件   |
| :w!      | 文件 覆盖一个已有的文件 |
| :w>>文件 | 将数据追加到指定的文件  |

## 切换到一个新文件

| 命令     | 效果                           |
| -------- | ------------------------------ |
| :e 文件  | 切换到新文件进行编辑           |
| :e!      | 重新编剧当前文件，忽略自动检查 |
| :e! 文件 | 编辑指定文件，忽略自动检查     |

## 使用缩写

| 命令                | 效果                                                                 |
| ------------------- | -------------------------------------------------------------------- |
| :ab 缩写 缩写的原文 | 在位于输入模式时，每当输入缩写（作为单独的单词），就会替换为缩写原文 |

ps：
可以为经常使用的单词或表达式创建缩写，缩写必须为一个单词（中间无空格），缩写原文可任意。

```
:ab eg exceptionally gifted
```

## 宏

| 命令             | 效果                                                                                |
| ---------------- | ----------------------------------------------------------------------------------- |
| :map 单字符 命令 | 创建命令模式中使用的单字符命令，自己定制的单字符命令                                |
| :map             | 显示所有宏                                                                          |
| :map             | #数字 命令 #数字代指 F1 ～ F10（#1 指 F1，#0 指 F10），用来创建一个宏，并赋给功能键 |

ps：
如果宏的名称是一个已经拥有其他含义的字符（如：x 删除光标所在字符），那么宏将替换掉这个字符的含义。
