---
layout: post
title:  "现代操作系统（02） 进程"
categories:  现代操作系统 进程
---

## 进程
进程是对正在运行程序的一个抽象。
在任何多道程序设计系统中，CPU由一个进程切换至另一个进程。在某一个瞬间，CPU只能运行一个进程，但是在1秒内，可能运行多个进程。

## 进程模型
在进程模型中，计算机中的任何可运行的软件，通常也包括操作系统，被组织成若干顺序进程。
一个进程就是一个正在执行程序的实例，包括程序计数器，寄存器和变量的当前值。
从概念上说，每个进程拥有他自己的虚拟CPU。

## 进程的创建
4种主要事件会导致进程的创建：
- 系统初始化
- 正在运行的程序执行了创建进程的系统调用
- 用户请求创建一个新进程
- 一个批处理作业的初始化
从技术上看，在所有这些情形中，新进程都是由于一个已存在的进程执行了一个用于创建进程的系统调用而创建的。
在UNIX系统中，只有一个系统调用可以用来创建新进程：fork。
fork会创建一个与调用进程相同的副本。父进程和子进程拥有相同的内存映像，同样的环境字符串和同样的打开文件。
通常，子进程接着执行execve，以修改其内存映像并运行一个新的程序。
之所以要分为两个步骤：是为了在fork之后，但在execve之前允许子进程处理其文件描述符，这样可以完成对标准输入文件，标准输出文件及标准错误文件的重定向。
进程创建之后，父进程和子进程有各自不同的地址空间。

## 进程的终止
4种主要条件引起进程终止：
- 正常退出（自愿的）
- 出错退出（自愿的）
- 严重错误（非自愿）
- 被其他进程杀死（非自愿）
多数进程是由于完成了它们的工作而终止。完成指定任务后执行一个系统调用（exit），通知操作系统工作已经完成。

## 进程的层次结构
在UNIX中，进程和它的所有子进程以及后裔共同组成一个进程组。
在整个系统中，所有进程都属于以init为根的一棵树。

## 进程的状态
进程的3种状态：
- 运行态（该时刻进程实际占用CPU）
- 就绪态（可运行，但因为其他进程正在运行而暂时停止）
- 阻塞态（初伏某种外部事件发生，否则进程不能运行）

4种转换关系：
- 运行 -》 阻塞（进程因为等待输入而被阻塞）
- 运行 -》 就绪（调度程序选择另一个进程）
- 就绪 -》 运行（调度程序选择该进程）
- 阻塞 -》 就绪（出现有效输入）

## 进程的实现
操作系统维护着一个表格，即进程表。
每个进程占用一个表项，包含了进程状态的重要信息，包括程序计数器，堆栈指针，内存分配状况，所打开文件的状态等。
